'use strict';

var LocationStream = require('./LocationStream'),
    ChangeInLocationTransform = require('./ChangeInLocationTransform');

module.exports = {
    /**
     *
     * @param {int} [id] - Satellite identifier
     * @param {int} [requestRate] - Max. num requests to send to the API per minute.
     * @returns {LocationStream}
     */
    locationStream: function (id, requestRate) {
        return new LocationStream(id, requestRate);
    },
    /**
     *
     * @param {int} [id] - Satellite identifier
     * @param {int} [requestRate] - Max. num requests to send to the API per minute.
     * @returns {ChangeInLocationTransform}
     */
    changeInLocationStream: function (id, requestRate) {
        var locationStream = new LocationStream(id, requestRate),
            changeInLocationTransform = new ChangeInLocationTransform();
        locationStream.pipe(changeInLocationTransform);
        var tempEnd = changeInLocationTransform.end;
        // Because the parent stream is infinite we need a way in which to end it. Once the parent
        // stream has ended, the transform stream is ended automatically.
        changeInLocationTransform.end = function () {
            changeInLocationTransform.end = tempEnd;
            locationStream.end();
        };
        return changeInLocationTransform;
    }
};